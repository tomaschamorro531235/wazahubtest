local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

-- Servicios y variables
local lp = game.Players.LocalPlayer
local RS = game:GetService("RunService")
local UIS = game:GetService("UserInputService")

local walkEnabled = false
local walkSpeedValue = 32
local movementConnection = nil
local wsReconnect = nil

-- Crear ventana Rayfield
local Window = Rayfield:CreateWindow({
	Name = "WalkSpeed Hub",
	LoadingTitle = "Cargando WalkSpeed...",
	LoadingSubtitle = "by waza",
	ConfigurationSaving = {
		Enabled = false
	},
	Discord = {
		Enabled = false
	},
	KeySystem = false
})

-- Tab de movimiento
local Tab_Movimiento = Window:CreateTab("Movimiento", 4483362458)

-- Slider de velocidad
Tab_Movimiento:CreateSlider({
	Name = "Velocidad WalkSpeed",
	Range = {16, 120},
	Increment = 1,
	Suffix = "Vel",
	CurrentValue = 32,
	Flag = "WalkSpeedSlider",
	Callback = function(Value)
		walkSpeedValue = Value
	end,
})

-- Toggle de WalkSpeed
Tab_Movimiento:CreateToggle({
	Name = "WalkSpeed",
	Flag = "WalkSpeedToggle",
	CurrentValue = false,
	Callback = function(enabled)
		walkEnabled = enabled

		if movementConnection then
			movementConnection:Disconnect()
			movementConnection = nil
		end
		if wsReconnect then
			wsReconnect:Disconnect()
			wsReconnect = nil
		end

		if enabled then
			local function applyWalkspeed()
				local isMobile = UIS.TouchEnabled and not UIS.KeyboardEnabled

				movementConnection = RS.RenderStepped:Connect(function()
					local char = lp.Character
					local cam = workspace.CurrentCamera
					if not char or not cam then return end

					local hrp = char:FindFirstChild("HumanoidRootPart")
					local hum = char:FindFirstChildOfClass("Humanoid")
					if not hrp or not hum then return end

					hum.PlatformStand = false
					hum:ChangeState(Enum.HumanoidStateType.Running)

					local moveVec = Vector3.zero

					if isMobile then
						moveVec = hum.MoveDirection
					else
						if UIS:IsKeyDown(Enum.KeyCode.W) then moveVec += cam.CFrame.LookVector end
						if UIS:IsKeyDown(Enum.KeyCode.S) then moveVec -= cam.CFrame.LookVector end
						if UIS:IsKeyDown(Enum.KeyCode.D) then moveVec += cam.CFrame.RightVector end
						if UIS:IsKeyDown(Enum.KeyCode.A) then moveVec -= cam.CFrame.RightVector end
					end

					local dir = moveVec.Magnitude > 0 and Vector3.new(moveVec.X, 0, moveVec.Z).Unit or Vector3.zero
					local velY = math.clamp(hrp.AssemblyLinearVelocity.Y, -50, 50)
					hrp.AssemblyLinearVelocity = dir * walkSpeedValue + Vector3.new(0, velY, 0)
				end)
			end

			applyWalkspeed()

			wsReconnect = lp.CharacterAdded:Connect(function()
				if walkEnabled then
					task.wait(0.5)
					applyWalkspeed()
				end
			end)
		end
	end
})
